!function a(l,i,c){function s(e,t){if(!i[e]){if(!l[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(u)return u(e,!0);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}var r=i[e]={exports:{}};l[e][0].call(r.exports,function(t){return s(l[e][1][t]||t)},r,r.exports,a,l,i,c)}return i[e].exports}for(var u="function"==typeof require&&require,t=0;t<c.length;t++)s(c[t]);return s}({1:[function(d,t,e){!function a(l,i,c){function s(e,t){if(!i[e]){if(!l[e]){var n="function"==typeof d&&d;if(!t&&n)return n(e,!0);if(u)return u(e,!0);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}var r=i[e]={exports:{}};l[e][0].call(r.exports,function(t){return s(l[e][1][t]||t)},r,r.exports,a,l,i,c)}return i[e].exports}for(var u="function"==typeof d&&d,t=0;t<c.length;t++)s(c[t]);return s}({1:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Data=l;document.getElementById("taskName"),document.getElementById("taskDate"),document.getElementById("taskContent");var o=document.getElementById("taskName2"),r=document.getElementById("taskDate2"),a=document.getElementById("taskContent2");document.querySelector("#content"),document.querySelector("#contents");function l(t){this.data=t}l.prototype.addCat=function(t,e){var n=this.data,r=[];t?function t(e,n){for(var o=0;o<n.length;o++)n[o].id==e&&(r=n[o].list),0!==n[o].list.length&&t(e,n[o].list)}(t,n):r=n,r.push(e)},l.prototype.setCatId=function(t){this.catId=t},l.prototype.setTaskId=function(t){this.taskId=t},l.prototype.setList=function(t){var a="",e=document.querySelector(t),l=this;!function t(e){for(var n=e,o=0;o<n.length;o++){var r;r=n==l.data?"<li>\n                            <h1><input type='button' value='X'><a data-id='".concat(n[o].id,"'>").concat(n[o].catName,"<span></span></a></h1>"):"<li>\n                            <h2><input type='button' value='X'><a data-id='".concat(n[o].id,"'>").concat(n[o].catName,"<span></span></a></h2>"),a+=r,0!==n[o].list.length?(a+="<ul class='ul2'>",t(n[o].list),a+="</ul></li>"):a+="</li>"}}(l.data),e.innerHTML=a},l.prototype.delCat=function(t,e){if(0==t)return!1;var r=[],a={};!function t(e,n){for(var o=0;o<n.length;o++)n[o].id==e&&(a=(r=n)[o]),0!==n[o].list.length&&t(e,n[o].list)}(t,this.data);for(var n=0;n<r.length;n++)r[n]==a&&r.splice(n,1);e.setList(".ul1"),e.setListener(e),e.setCatId(null)},l.prototype.setTask=function(t,e){var n=document.querySelector(t);n.innerHTML="";var o=this.catId,r=[];!function t(e,n){for(var o=0;o<n.length;o++)n[o].id==e&&(r=n[o].task),0!==n[o].list.length&&t(e,n[o].list)}(o,this.data);var a=[];if(0!==(this.taskArr=r).length){for(var l=0;l<r.length;l++){var i=document.createElement("li");i.innerHTML="<input type='button' value='X'><a>".concat(r[l].title,"</a>"),i.setAttribute("task-id",r[l].taskId),i.onclick=function(){document.querySelector(".hover2")&&document.querySelector(".hover2").classList.remove("hover2"),this.classList.add("hover2"),e.setTaskId(this.getAttribute("task-id")),e.showTask("#content",e)},i.firstElementChild.onclick=function(){e.delTask(o,this.parentElement.getAttribute("task-id"),e)},1==r[l].done&&i.classList.add("donetrue");for(var c=!0,s=0;s<a.length;s++)if(a[s].getAttribute("data-time")==r[l].time){a[s].appendChild(i),c=!1;break}if(c){var u=document.createElement("ul");u.classList.add("ul3"),u.innerHTML="<span>".concat(r[l].time,"</span>"),u.setAttribute("data-time",r[l].time),u.appendChild(i),a.push(u)}}a.sort(function(t,e){return t.firstElementChild.innerHTML.replace(/-/g,"")-e.firstElementChild.innerHTML.replace(/-/g,"")}),a.forEach(function(t){n.appendChild(t)})}else n.innerHTML="该分类下没有任务"},l.prototype.addTask=function(t,e){var n=this.data,r=[];!function t(e,n){for(var o=0;o<n.length;o++)n[o].id==e&&(r=n[o].task),0!==n[o].list.length&&t(e,n[o].list)}(t,n),r.push(e)},l.prototype.showTask=function(t,e){var n=document.querySelector(t),o=e.catId,r=e.taskId,a=[];!function t(e,n){for(var o=0;o<n.length;o++)n[o].id==e&&(a=n[o].task),0!==n[o].list.length&&t(e,n[o].list)}(o,this.data);for(var l=0;l<a.length;l++)a[l].taskId==r&&(n.querySelector("#taskName2").innerHTML=a[l].title,n.querySelector("#taskDate2").innerHTML=a[l].time,n.querySelector("#taskContent2").innerHTML=a[l].content)},l.prototype.changeTask=function(t,e,n,o){var r=this.data,a=[];!function t(e,n){for(var o=0;o<n.length;o++)n[o].id==e&&(a=n[o].task),0!==n[o].list.length&&t(e,n[o].list)}(t,r);for(var l=0;l<a.length;l++)if(a[l].taskId==e)for(var i in a[l])n[i]&&n[i]!==a[l][i]&&(a[l][i]=n[i]),"boolean"==typeof n[i]&&n[i]!==a[l][i]&&(a[l][i]=n[i]);o.setTask("#list2",o),o.setListener(o);var c=document.querySelectorAll("#list1 li");document.querySelector(".hover3").classList.remove("hover3"),c[0].classList.add("hover3")},l.prototype.delTask=function(t,e,n){if(0==e)return!1;var r=[];!function t(e,n){for(var o=0;o<n.length;o++)n[o].id==e&&(r=n[o].task),0!==n[o].list.length&&t(e,n[o].list)}(t,this.data);for(var o=0;o<r.length;o++)r[o].taskId==e&&r.splice(o,1);n.setTask("#list2",n),n.setListener(n),n.setTaskId(null)},l.prototype.setListener=function(n){document.querySelector(".ul1").querySelectorAll("a").forEach(function(e){e.onclick=function(){document.querySelector(".hover")&&document.querySelector(".hover").classList.remove("hover");var t=e.parentElement.parentElement.querySelector(".ul2");t&&("none"==t.style.display?t.style.display="block":t.style.display="none"),e.classList.add("hover"),n.setCatId(this.getAttribute("data-id")),n.setTask("#list2",n),document.querySelectorAll("#list2 li").forEach(function(t){t.onclick=function(){document.querySelector(".hover2")&&document.querySelector(".hover2").classList.remove("hover2"),t.classList.add("hover2"),n.setTaskId(this.getAttribute("task-id")),n.showTask("#content",n)}})},e.previousElementSibling.onclick=function(){n.delCat(e.getAttribute("data-id"),n)}}),document.getElementById("task1").onclick=function(){event.target==this&&(document.querySelector(".hover")&&document.querySelector(".hover").classList.remove("hover"),n.setCatId(null),n.setTask("#list2",n),function(t,e){[o,r,a].forEach(function(t){t.innerHTML=""})}(0))},n.showCount(),1==document.querySelectorAll(".ul1 a").length&&(document.querySelector(".hover")||document.querySelector(".ul1 a").click(),1==document.querySelectorAll(".ul3 li").length&&document.querySelector(".ul3 li").click())},l.prototype.showCount=function(){var t=document.querySelectorAll(".ul1 a"),e=this.data,n=document.getElementById("countTask"),o=0;t.forEach(function(t){var r=0;!function t(e,n){for(var o=0;o<n.length;o++)n[o].id==e&&function t(e){for(var n=0;n<e.task.length;n++)0==e.task[n].done&&r++;for(var o=0;o<e.list.length;o++)t(e.list[o])}(n[o]),0!==n[o].list.length&&t(e,n[o].list)}(t.getAttribute("data-id"),e),t.firstElementChild.innerHTML="(".concat(r,")"),"ul1"==t.parentElement.parentElement.parentElement.getAttribute("class")&&(o+=r)}),n.innerHTML="(".concat(o,")")}},{}],2:[function(d,t,e){!function a(l,i,c){function s(e,t){if(!i[e]){if(!l[e]){var n="function"==typeof d&&d;if(!t&&n)return n(e,!0);if(u)return u(e,!0);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}var r=i[e]={exports:{}};l[e][0].call(r.exports,function(t){return s(l[e][1][t]||t)},r,r.exports,a,l,i,c)}return i[e].exports}for(var u="function"==typeof d&&d,t=0;t<c.length;t++)s(c[t]);return s}({1:[function(t,e,n){"use strict";function o(){this.setting={title:"默认分类",type:null}}Object.defineProperty(n,"__esModule",{value:!0}),(n.List=o).prototype.setTask=function(t){!function(t,e){for(var n in e)t[n]=e[n]}(this.setting,t)},o.prototype.create=function(t){var e=prompt("请输入要添加的分类名称\n父目录为：".concat(this.setting.title)),n=t.catId;if(!e||-1!==e.search(/[\<\>]/))return alert("分类名不符合格式"),!1;var o={catName:e,id:Date.parse(new Date),task:[],list:[]};t.addCat(n,o),t.setList(".ul1"),t.setListener(t)}},{}]},{},[1])},{}],3:[function(t,e,n){"use strict";var o=t("./list.js"),r=t("./data.js"),l=document.getElementById("task"),i=document.getElementById("list"),a=document.getElementById("taskName"),c=document.getElementById("taskDate"),s=document.getElementById("taskContent"),u=document.getElementById("taskName2"),d=document.getElementById("taskDate2"),f=document.getElementById("taskContent2"),h=document.querySelector("#content"),v=document.querySelector("#contents");if(localStorage.allData)var y=JSON.parse(localStorage.allData);else y=[{id:0,catName:"默认分类",task:[{taskId:0,title:"默认分类示例",time:"1970-01-01",done:!0,content:"任务内容"}],list:[]}],localStorage.allData=JSON.stringify(y);function m(t,e){var n=1<arguments.length&&void 0!==e?e:1;0==t?([u,d,f].forEach(function(t){t.innerHTML=""}),0==n&&(h.style.display="none",v.style.display="block")):([a,c,s].forEach(function(t){t.value=""}),0==n&&(v.style.display="none",h.style.display="block"))}document.getElementById("addCat").onclick=function(){if(document.querySelector(".hover")&&"默认分类"==document.querySelector(".hover").childNodes[0].nodeValue)return!1;var t=new o.List;t.setTask({title:document.querySelector(".hover")?document.querySelector(".hover").innerText:"无",type:"newCat"}),t.create(k)},document.getElementById("addTask").onclick=function(){var t=k.catId;document.querySelector(".hover2")&&document.querySelector(".hover2").classList.remove("hover2"),t&&(m(0,0),l.style.pointerEvents="none",i.style.pointerEvents="none")},document.querySelector("#contents input[value='取消']").onclick=function(){m(1,0),l.style.pointerEvents="",i.style.pointerEvents=""},document.querySelector("#contents input[value='确认']").onclick=function(){var t=document.getElementById("taskName"),e=document.getElementById("taskDate"),n=document.getElementById("taskContent"),o=k.catId,r=k.taskId;if(0==t.value.length||10<t.value.length||-1==e.value.search(/^\d{4}\-\d{2}\-\d{2}$/)||0==n.value.length)return!1;if(-1!==(t.value.search(/[\<\>]/)||n.value.search(/[\<\>]/)))return!1;if(document.querySelector(".hover2"))a={title:t.value,time:e.value,content:n.value},k.changeTask(o,r,a,k),m(0);else{var a={taskId:Date.parse(new Date),title:t.value,time:e.value,done:!1,content:n.value};k.addTask(o,a),k.setTask("#list2",k),k.setListener(k)}m(1,0),l.style.pointerEvents="",i.style.pointerEvents=""},[document.querySelector("#content input[value='取消完成']"),document.querySelector("#content input[value='完成']"),document.querySelector("#content input[value='编辑']")].forEach(function(t){t.onclick=function(){document.querySelector(".hover")&&document.querySelector(".hover2")&&function(t){var e=t.value,n=k.catId,o=k.taskId;switch(e){case"取消完成":t={done:!1},k.changeTask(n,o,t,k);break;case"完成":t={done:!0},k.changeTask(n,o,t,k);break;case"编辑":if(0==k.taskId)return;a.value=u.innerHTML,c.value=d.innerHTML,s.value=f.innerHTML,h.style.display="none",v.style.display="block",l.style.pointerEvents="none",i.style.pointerEvents="none"}}(this)}});var p=document.querySelectorAll("#list1 li");p[0].classList.add("hover3"),p.forEach(function(t){t.onclick=function(){document.querySelector(".hover3")&&document.querySelector(".hover3").classList.remove("hover3"),t.classList.add("hover3"),function(t,e){var n=document.querySelector("#list2"),o=n.querySelectorAll("li"),r=n.querySelectorAll(".donetrue");switch(e){case"所有":o.forEach(function(t){t.style.display="block"});break;case"未完成":o.forEach(function(t){t.style.display="block"}),r.forEach(function(t){t.style.display="none"});break;case"已完成":o.forEach(function(t){t.style.display="none"}),r.forEach(function(t){t.style.display="block"})}}(0,t.firstChild.nodeValue)}});var k=new r.Data(y);k.setList(".ul1"),k.setListener(k),window.onunload=function(){localStorage.allData=JSON.stringify(k.data)}},{"./data.js":1,"./list.js":2}]},{},[3])},{}]},{},[1]);
//# sourceMappingURL=old.js.map
