(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
/*!  2019-11-05 */
"use strict";function Data(a){this.data=a}function reset(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;0==a?([taskName2,taskDate2,taskContent2].forEach(function(a){a.innerHTML=""}),0==b&&(content.style.display="none",contents.style.display="block")):([taskName,taskDate,taskContent].forEach(function(a){a.value=""}),0==b&&(contents.style.display="none",content.style.display="block"))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Data=Data;var taskName=document.getElementById("taskName"),taskDate=document.getElementById("taskDate"),taskContent=document.getElementById("taskContent"),taskName2=document.getElementById("taskName2"),taskDate2=document.getElementById("taskDate2"),taskContent2=document.getElementById("taskContent2"),content=document.querySelector("#content"),contents=document.querySelector("#contents");Data.prototype.addCat=function(a,b){var c=this.data,d=[];a?function a(b,c){for(var e=0;e<c.length;e++)c[e].id==b&&(d=c[e].list),0!==c[e].list.length&&a(b,c[e].list)}(a,c):d=c,d.push(b)},Data.prototype.setCatId=function(a){this.catId=a},Data.prototype.setTaskId=function(a){this.taskId=a},Data.prototype.setList=function(a){var b="",c=document.querySelector(a),d=this;!function a(c){for(var e=c,f=0;f<e.length;f++){var g="";g=e==d.data?"<li>\n                            <h1><input type='button' value='X'><a data-id='".concat(e[f].id,"'>").concat(e[f].catName,"<span></span></a></h1>"):"<li>\n                            <h2><input type='button' value='X'><a data-id='".concat(e[f].id,"'>").concat(e[f].catName,"<span></span></a></h2>"),b+=g,0!==e[f].list.length?(b+="<ul class='ul2'>",a(e[f].list),b+="</ul></li>"):b+="</li>"}}(d.data),c.innerHTML=b},Data.prototype.delCat=function(a,b){if(0==a)return!1;var c=[],d={};!function a(b,e){for(var f=0;f<e.length;f++)e[f].id==b&&(c=e,d=e[f]),0!==e[f].list.length&&a(b,e[f].list)}(a,this.data);for(var e=0;e<c.length;e++)c[e]==d&&c.splice(e,1);b.setList(".ul1"),b.setListener(b),b.setCatId(null)},Data.prototype.setTask=function(a,b){var c=document.querySelector(a);c.innerHTML="";var d=this.catId,e=[];!function a(b,c){for(var d=0;d<c.length;d++)c[d].id==b&&(e=c[d].task),0!==c[d].list.length&&a(b,c[d].list)}(d,this.data),this.taskArr=e;var f=[];if(0!==e.length){for(var g=0;g<e.length;g++){var h=document.createElement("li");h.innerHTML="<input type='button' value='X'><a>".concat(e[g].title,"</a>"),h.setAttribute("task-id",e[g].taskId),h.onclick=function(){document.querySelector(".hover2")&&document.querySelector(".hover2").classList.remove("hover2"),this.classList.add("hover2"),b.setTaskId(this.getAttribute("task-id")),b.showTask("#content",b)},h.firstElementChild.onclick=function(){b.delTask(d,this.parentElement.getAttribute("task-id"),b)},1==e[g].done&&h.classList.add("donetrue");for(var i=!0,j=0;j<f.length;j++)if(f[j].getAttribute("data-time")==e[g].time){f[j].appendChild(h),i=!1;break}if(i){var k=document.createElement("ul");k.classList.add("ul3"),k.innerHTML="<span>".concat(e[g].time,"</span>"),k.setAttribute("data-time",e[g].time),k.appendChild(h),f.push(k)}}f.sort(function(a,b){return a.firstElementChild.innerHTML.replace(/-/g,"")-b.firstElementChild.innerHTML.replace(/-/g,"")}),f.forEach(function(a){c.appendChild(a)})}else c.innerHTML="该分类下没有任务"},Data.prototype.addTask=function(a,b){var c=this.data,d=[];!function a(b,c){for(var e=0;e<c.length;e++)c[e].id==b&&(d=c[e].task),0!==c[e].list.length&&a(b,c[e].list)}(a,c),d.push(b)},Data.prototype.showTask=function(a,b){var c=document.querySelector(a),d=b.catId,e=b.taskId,f=[];!function a(b,c){for(var d=0;d<c.length;d++)c[d].id==b&&(f=c[d].task),0!==c[d].list.length&&a(b,c[d].list)}(d,this.data);for(var g=0;g<f.length;g++)f[g].taskId==e&&(c.querySelector("#taskName2").innerHTML=f[g].title,c.querySelector("#taskDate2").innerHTML=f[g].time,c.querySelector("#taskContent2").innerHTML=f[g].content)},Data.prototype.changeTask=function(a,b,c,d){var e=this.data,f=[];!function a(b,c){for(var d=0;d<c.length;d++)c[d].id==b&&(f=c[d].task),0!==c[d].list.length&&a(b,c[d].list)}(a,e);for(var g=0;g<f.length;g++)if(f[g].taskId==b)for(var h in f[g])c[h]&&c[h]!==f[g][h]&&(f[g][h]=c[h]),"boolean"==typeof c[h]&&c[h]!==f[g][h]&&(f[g][h]=c[h]);d.setTask("#list2",d),d.setListener(d);var i=document.querySelectorAll("#list1 li");document.querySelector(".hover3").classList.remove("hover3"),i[0].classList.add("hover3")},Data.prototype.delTask=function(a,b,c){if(0==b)return!1;var d=[];!function a(b,c){for(var e=0;e<c.length;e++)c[e].id==b&&(d=c[e].task),0!==c[e].list.length&&a(b,c[e].list)}(a,this.data);for(var e=0;e<d.length;e++)d[e].taskId==b&&d.splice(e,1);c.setTask("#list2",c),c.setListener(c),c.setTaskId(null)},Data.prototype.setListener=function(a){document.querySelector(".ul1").querySelectorAll("a").forEach(function(b){b.onclick=function(){document.querySelector(".hover")&&document.querySelector(".hover").classList.remove("hover");var c=b.parentElement.parentElement.querySelector(".ul2");c&&("none"==c.style.display?c.style.display="block":c.style.display="none"),b.classList.add("hover"),a.setCatId(this.getAttribute("data-id")),a.setTask("#list2",a),document.querySelectorAll("#list2 li").forEach(function(b){b.onclick=function(){document.querySelector(".hover2")&&document.querySelector(".hover2").classList.remove("hover2"),b.classList.add("hover2"),a.setTaskId(this.getAttribute("task-id")),a.showTask("#content",a)}})},b.previousElementSibling.onclick=function(){a.delCat(b.getAttribute("data-id"),a)}}),document.getElementById("task1").onclick=function(){event.target==this&&(document.querySelector(".hover")&&document.querySelector(".hover").classList.remove("hover"),a.setCatId(null),a.setTask("#list2",a),reset(0))},a.showCount(),1==document.querySelectorAll(".ul1 a").length&&(document.querySelector(".hover")||document.querySelector(".ul1 a").click(),1==document.querySelectorAll(".ul3 li").length&&document.querySelector(".ul3 li").click())},Data.prototype.showCount=function(){var a=document.querySelectorAll(".ul1 a"),b=this.data,c=document.getElementById("countTask"),d=0;a.forEach(function(a){var c=0,e={};!function a(b,d){for(var f=0;f<d.length;f++)d[f].id==b&&(e=d[f],function a(b){for(var d=0;d<b.task.length;d++)0==b.task[d].done&&c++;for(var e=0;e<b.list.length;e++)a(b.list[e])}(e)),0!==d[f].list.length&&a(b,d[f].list)}(a.getAttribute("data-id"),b),a.firstElementChild.innerHTML="(".concat(c,")"),"ul1"==a.parentElement.parentElement.parentElement.getAttribute("class")&&(d+=c)}),c.innerHTML="(".concat(d,")")};
},{}],2:[function(require,module,exports){
/*!  2019-11-05 */
"use strict";function List(){this.setting={title:"默认分类",type:null}}function thing(a,b){for(var c in b)a[c]=b[c]}Object.defineProperty(exports,"__esModule",{value:!0}),exports.List=List,List.prototype.setTask=function(a){thing(this.setting,a)},List.prototype.create=function(a){var b=prompt("请输入要添加的分类名称\n父目录为：".concat(this.setting.title)),c=a.catId;if(!b||-1!==b.search(/[\<\>]/))return alert("分类名不符合格式"),!1;var d={catName:b,id:Date.parse(new Date),task:[],list:[]};a.addCat(c,d),a.setList(".ul1"),a.setListener(a)};
},{}],3:[function(require,module,exports){
/*!  2019-11-05 */
"use strict";function fliter(a){var b=a.value,c=data1.catId,d=data1.taskId;switch(b){case"取消完成":var a={done:!1};data1.changeTask(c,d,a,data1);break;case"完成":var a={done:!0};data1.changeTask(c,d,a,data1);break;case"编辑":if(0==data1.taskId)return!1;taskName.value=taskName2.innerHTML,taskDate.value=taskDate2.innerHTML,taskContent.value=taskContent2.innerHTML,content.style.display="none",contents.style.display="block",task.style.pointerEvents="none",list.style.pointerEvents="none"}}function reset(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;0==a?([taskName2,taskDate2,taskContent2].forEach(function(a){a.innerHTML=""}),0==b&&(content.style.display="none",contents.style.display="block")):([taskName,taskDate,taskContent].forEach(function(a){a.value=""}),0==b&&(contents.style.display="none",content.style.display="block"))}var _list=require("./list.js"),_data=require("./data.js"),task=document.getElementById("task"),list=document.getElementById("list"),taskName=document.getElementById("taskName"),taskDate=document.getElementById("taskDate"),taskContent=document.getElementById("taskContent"),taskName2=document.getElementById("taskName2"),taskDate2=document.getElementById("taskDate2"),taskContent2=document.getElementById("taskContent2"),content=document.querySelector("#content"),contents=document.querySelector("#contents");if(localStorage.allData)var json=JSON.parse(localStorage.allData);else{var json=[{id:0,catName:"默认分类",task:[{taskId:0,title:"默认分类示例",time:"1970-01-01",done:!0,content:"任务内容"}],list:[]}];localStorage.allData=JSON.stringify(json)}var selectTask=function(a,b){var c=document.querySelector(a),d=c.querySelectorAll("li"),e=c.querySelectorAll(".donetrue");switch(b){case"所有":d.forEach(function(a){a.style.display="block"});break;case"未完成":d.forEach(function(a){a.style.display="block"}),e.forEach(function(a){a.style.display="none"});break;case"已完成":d.forEach(function(a){a.style.display="none"}),e.forEach(function(a){a.style.display="block"})}},addCat=document.getElementById("addCat");addCat.onclick=function(){if(document.querySelector(".hover")&&"默认分类"==document.querySelector(".hover").childNodes[0].nodeValue)return!1;var a=new _list.List;a.setTask({title:document.querySelector(".hover")?document.querySelector(".hover").innerText:"无",type:"newCat"}),a.create(data1)};var addTask=document.getElementById("addTask");addTask.onclick=function(){var a=data1.catId;document.querySelector(".hover2")&&document.querySelector(".hover2").classList.remove("hover2"),a&&(reset(0,0),task.style.pointerEvents="none",list.style.pointerEvents="none")};var quit=document.querySelector("#contents input[value='取消']");quit.onclick=function(){reset(1,0),task.style.pointerEvents="",list.style.pointerEvents=""};var deter=document.querySelector("#contents input[value='确认']");deter.onclick=function(){var a=document.getElementById("taskName"),b=document.getElementById("taskDate"),c=document.getElementById("taskContent"),d=data1.catId,e=data1.taskId;if(0==a.value.length||a.value.length>10||-1==b.value.search(/^\d{4}\-\d{2}\-\d{2}$/)||0==c.value.length)return!1;if(-1!==(a.value.search(/[\<\>]/)||c.value.search(/[\<\>]/)))return!1;if(document.querySelector(".hover2")){var f={title:a.value,time:b.value,content:c.value};data1.changeTask(d,e,f,data1),reset(0)}else{var f={taskId:Date.parse(new Date),title:a.value,time:b.value,done:!1,content:c.value};data1.addTask(d,f),data1.setTask("#list2",data1),data1.setListener(data1)}reset(1,0),task.style.pointerEvents="",list.style.pointerEvents=""};var quitComp=document.querySelector("#content input[value='取消完成']"),complete=document.querySelector("#content input[value='完成']"),edit=document.querySelector("#content input[value='编辑']");[quitComp,complete,edit].forEach(function(a){a.onclick=function(){document.querySelector(".hover")&&document.querySelector(".hover2")&&fliter(this)}});var listLi=document.querySelectorAll("#list1 li");listLi[0].classList.add("hover3"),listLi.forEach(function(a){a.onclick=function(){document.querySelector(".hover3")&&document.querySelector(".hover3").classList.remove("hover3"),a.classList.add("hover3"),selectTask("#list2",a.firstChild.nodeValue)}});var data1=new _data.Data(json);data1.setList(".ul1"),data1.setListener(data1),window.onunload=function(){localStorage.allData=JSON.stringify(data1.data)};
},{"./data.js":1,"./list.js":2}]},{},[3]);
