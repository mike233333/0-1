<html>
<title>task23</title>
<style>
    div {
        display: flex;
    }

    .div1 {
        width: 99%;
        height: 80%;
        border: 5px solid black;
    }

    .div2 {
        flex: 1;
        margin: 20px;
        border: 5px solid red;
    }

    .div3 {
        flex: 1;
        margin: 5px;
        border: 5px solid grey;
    }

    .div4 {
        flex: 1;
        margin: 5px;
        border: 5px solid green;
    }

    .div5 {
        flex: 1;
        margin: 5px;
        border: 2px solid blue;
    }

    .hover {
        background-color: red;
    }
</style>

<body>
    <div class="div1">1
        <div class="div2">2
            <div class="div3">3</div>
            <div class="div3">4
                <div class="div4">5</div>
                <div class="div4">6</div>
                <div class="div4">7</div>
            </div>
            <div class="div3">8</div>
        </div>
        <div class="div2">9
            <div class="div3">10
                <div class="div4">11</div>
                <div class="div4">12</div>
                <div class="div4">13
                    <div class="div5">14</div>
                    <div class="div5">15</div>
                    <div class="div5">16</div>
                </div>
            </div>
            <div class="div3">17</div>
            <div class="div3">18</div>
        </div>
        <div class="div2">19</div>
    </div>
    <br>
    <input type="text">
    <input type="button" value='检索'>
    <input type="text">
    <input type="button" value="添加">
    <input type="button" value="删除">
    <script>
        var div = document.querySelectorAll('div');
        var root = document.querySelector('.div1');
        var data = [];
        var text = document.querySelector('input');
        var button = document.querySelectorAll('input')[1];
        var add = document.querySelector('input[value=添加]');
        var remove = document.querySelector('input[value=删除]');
        var addText = document.querySelectorAll('input')[2];
        const preo = (node) => {
            if (node) {
                data.push(node);
                for (let i = 0; i < node.childNodes.length; i++) {
                    if (node.childNodes[i] && node.childNodes[i].nodeType === 1) {
                        preo(node.childNodes[i]);
                    }
                }
            }
        }
        const show = (text) => {
            var obj = data.shift();
            if (obj) {
                obj.style.backgroundColor = 'red';
                if (obj.firstChild.nodeValue.trim() === text) {
                    console.log('get!');
                    return false;
                }
                time = setTimeout(() => {
                    obj.style.backgroundColor = 'white';
                    show(text);
                }, 500)
            } else {
                console.log('none!');
            }
        }
        button.onclick = () => {
            div.forEach(item => {
                item.style.backgroundColor = 'white';
            });
            data = [];
            preo(root);
            if (text.value.trim().length !== 0) {
                show(text.value.trim());
            }
        }
        document.onclick = () => {
            if (event.target.nodeName === "DIV" || event.target.nodeName === "BODY") {
                if (document.querySelector('.hover')) {
                    document.querySelector('.hover').classList.remove('hover');
                }
            }
            if (event.target.nodeName === "DIV") {
                event.target.classList.add('hover');
            }
        }
        add.onclick = () => {
            var node = document.querySelector('.hover');
            if (node) {
                var cssList = node.classList[0];
                var newDiv = document.createElement('div');
                var num = Number(cssList.substring(3)) + 1;
                newDiv.classList.add('div' + num);
                newDiv.innerHTML = addText.value;
                node.appendChild(newDiv);
            } else {
                return false;
            }
        }
        remove.onclick = () => {
            var node = document.querySelector('.hover');
            if (node) {
                node.parentNode.removeChild(node);
            }
        }
    </script>
</body>

</html>